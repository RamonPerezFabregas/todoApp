var TodoApp;!function(o){var t=function(){function o(o){this._todoData=o}return o.prototype.getHTML=function(){return'\n            <li class="listUOC-item">\n                <div href="#" class="listUOC-item-todo">'+this._todoData.todoTxt+'</div>\n                <button data-id="'+this._todoData.id+'"  class="btn btUOC listUOC-item-removeBt btUOC-grey"><span class="glyphicon glyphicon-trash"></span> Remove</button>\n            </li>\n            '},o}();o.TodoItem=t}(TodoApp||(TodoApp={}));var TodoApp;!function(o){var t=function(){function t(){var o=this;this._todoList=[],this._idCounter=0,this.saveNewTodo=function(){console.log("//SAVE NEW TODO");var t=o.$newTodoInput.val();if(""!=t){var s={id:o._idCounter,todoTxt:t};o.addTodo(s,!0),o.$newTodoInput.val("")}},this.onLoadTodosDataSuccess=function(t){var s,i,e;for(i=t.length,s=0;s<i;s++)e=t[s],o.addTodo(e,!1);o.render()},this.onLoadTodosDataError=function(){console.log("Error loading data.")},this.deleteTodo=function(t){console.log("//DELETE ITEM");var s=$(t.currentTarget);console.log("CLICK:"+parseInt(s.data("id"))),o.deleteTodoById(parseInt(s.data("id")))},this.$todoList=$(t.DOM_TODOLIST),this.$saveTodoBt=$(t.DOM_SAVETODO_BT),this.$newTodoInput=$(t.DOM_NEWTODO_INPUT),this.$todoList.on("click",".listUOC-item-removeBt",this.deleteTodo),this.$saveTodoBt.on("click",this.saveNewTodo),$("form").submit(function(){return!1}),this.checkTodoListData()}return t.prototype.render=function(){console.log("//RENDER");var s=$(t.DOM_TODOLIST_CONTAINER);this.$todoList.detach(),this.$todoList.empty();for(var i=0;i<this._todoList.length;i++){var e=new o.TodoItem(this._todoList[i]);this.$todoList.append(e.getHTML())}s.append(this.$todoList)},t.prototype.checkTodoListData=function(){var o,s;o=store.get(t.PERSISTENT_OBJECT_KEY),s=$(t.DOM_ALERT_FIRST_TIME),o?(s.remove(),this.onLoadTodosDataSuccess(o)):(console.log("//NO DATA"),this.loadFirstTimeData())},t.prototype.loadFirstTimeData=function(){$.ajax({dataType:"json",url:t.PERSISTENT_OBJECT_DATA_PATH,success:this.onLoadTodosDataSuccess,error:this.onLoadTodosDataError})},t.prototype.savePersistentData=function(){var o,s,i,e,T;for(T=[],s=this._todoList.length,o=0;o<s;o++)i=this._todoList[o],e={},e[t.PERSISTENT_OBJECT_TODO_ID]=i.id,e[t.PERSISTENT_OBJECT_TODO_TXT]=i.todoTxt,T.push(e);store.clear(),store.set(t.PERSISTENT_OBJECT_KEY,T)},t.prototype.addTodo=function(o,t){this._todoList.push(o),this._idCounter++,this.savePersistentData(),t&&this.render()},t.prototype.deleteTodoById=function(o){console.log("TODO DELETED");var t=0,s=this._todoList.length;for(t=0;t<s;t++)if(this._todoList[t].id==o){this._todoList.splice(t,1);break}this.savePersistentData(),this.render()},t}();t.DOM_TODOLIST_CONTAINER="#todo-list-container",t.DOM_TODOLIST="#todo-list",t.DOM_NEWTODO_INPUT="#new-todo-input",t.DOM_SAVETODO_BT="#save-todo-bt",t.DOM_ALERT_FIRST_TIME="#alert-first-time",t.PERSISTENT_OBJECT_KEY="todoList",t.PERSISTENT_OBJECT_DATA_PATH="data/defaultdata.json",t.PERSISTENT_OBJECT_TODO_ID="id",t.PERSISTENT_OBJECT_TODO_TXT="todoTxt",o.TodoList=t}(TodoApp||(TodoApp={}));var app;window.onload=function(){console.log("/// APP INIT"),app=new TodoApp.TodoList};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy90cy9Ub2RvSXRlbS50cyIsInNyYy90cy9Ub2RvTGlzdC50cyJdLCJuYW1lcyI6WyJUb2RvQXBwIiwiVG9kb0l0ZW0iLCJ0b2RvRGF0YSIsInRoaXMiLCJfdG9kb0RhdGEiLCJwcm90b3R5cGUiLCJnZXRIVE1MIiwidG9kb1R4dCIsImlkIiwiVG9kb0xpc3QiLCJfdGhpcyIsIl90b2RvTGlzdCIsIl9pZENvdW50ZXIiLCJzYXZlTmV3VG9kbyIsImNvbnNvbGUiLCJsb2ciLCIkbmV3VG9kb0lucHV0IiwidmFsIiwibmV3VG9kbyIsImFkZFRvZG8iLCJvbkxvYWRUb2Rvc0RhdGFTdWNjZXNzIiwiZGF0YSIsImkiLCJuVG9kb3MiLCJjdXJyZW50VG9kb0RhdGEiLCJsZW5ndGgiLCJyZW5kZXIiLCJvbkxvYWRUb2Rvc0RhdGFFcnJvciIsImRlbGV0ZVRvZG8iLCJlIiwiJHRhcmdldCIsIiQiLCJjdXJyZW50VGFyZ2V0IiwicGFyc2VJbnQiLCJkZWxldGVUb2RvQnlJZCIsIiR0b2RvTGlzdCIsIkRPTV9UT0RPTElTVCIsIiRzYXZlVG9kb0J0IiwiRE9NX1NBVkVUT0RPX0JUIiwiRE9NX05FV1RPRE9fSU5QVVQiLCJvbiIsInN1Ym1pdCIsImNoZWNrVG9kb0xpc3REYXRhIiwiJHRvZG9MaXN0Q29udGFpbmVyIiwiRE9NX1RPRE9MSVNUX0NPTlRBSU5FUiIsImRldGFjaCIsImVtcHR5IiwiaXRlbSIsImFwcGVuZCIsInN0b3JlZERhdGEiLCIkYWxlcnRGaXJzdFRpbWUiLCJzdG9yZSIsImdldCIsIlBFUlNJU1RFTlRfT0JKRUNUX0tFWSIsIkRPTV9BTEVSVF9GSVJTVF9USU1FIiwicmVtb3ZlIiwibG9hZEZpcnN0VGltZURhdGEiLCJhamF4IiwiZGF0YVR5cGUiLCJ1cmwiLCJQRVJTSVNURU5UX09CSkVDVF9EQVRBX1BBVEgiLCJzdWNjZXNzIiwiZXJyb3IiLCJzYXZlUGVyc2lzdGVudERhdGEiLCJjdXJyZW50VG9kbyIsInNhdmVkVG9kbyIsInRvZG9MaXN0SlNPTiIsIlBFUlNJU1RFTlRfT0JKRUNUX1RPRE9fSUQiLCJQRVJTSVNURU5UX09CSkVDVF9UT0RPX1RYVCIsInB1c2giLCJjbGVhciIsInNldCIsIm5ld1RvZG9EYXRhIiwiZm9yY2VSZW5kZXIiLCJzcGxpY2UiLCJhcHAiLCJ3aW5kb3ciLCJvbmxvYWQiXSwibWFwcGluZ3MiOiJBQUdBLEdBQVVBLFVBQVYsU0FBVUEsR0FPTixHQUFBQyxHQUFBLFdBTUksUUFBQUEsR0FBYUMsR0FHVEMsS0FBS0MsVUFBWUYsRUFnQnpCLE1BYklELEdBQUFJLFVBQUFDLFFBQUEsV0FXSSxNQVBXLG9HQUVtQ0gsS0FBS0MsVUFBVUcsUUFBTyw0Q0FDN0NKLEtBQUtDLFVBQVVJLEdBQUUsMEpBTWhEUCxJQXpCYUQsR0FBQUMsU0FBUUEsR0FQZkQsVUFBQUEsWUNBVixJQUFVQSxVQUFWLFNBQVVBLEdBRU4sR0FBQVMsR0FBQSxXQXdCSSxRQUFBQSxLQUFBLEdBQUFDLEdBQUFQLElBSFFBLE1BQUFRLGFBQ0FSLEtBQUFTLFdBQXFCLEVBNENyQlQsS0FBQVUsWUFBYyxXQUVsQkMsUUFBUUMsSUFBSSxrQkFHWixJQUFJUixHQUFpQkcsRUFBS00sY0FBY0MsS0FHeEMsSUFBWSxJQUFUVixFQUFZLENBR1gsR0FBSVcsSUFDQVYsR0FBSUUsRUFBS0UsV0FDVEwsUUFBU0EsRUFFYkcsR0FBS1MsUUFBUUQsR0FBUyxHQUd0QlIsRUFBS00sY0FBY0MsSUFBSSxNQWlDdkJkLEtBQUFpQix1QkFBeUIsU0FBRUMsR0FDL0IsR0FBSUMsR0FDQUMsRUFDQUMsQ0FHSixLQURBRCxFQUFTRixFQUFLSSxPQUNUSCxFQUFFLEVBQUdBLEVBQUVDLEVBQVFELElBRWhCRSxFQUFrQkgsRUFBS0MsR0FDdkJaLEVBQUtTLFFBQVNLLEdBQWlCLEVBR25DZCxHQUFLZ0IsVUFHRHZCLEtBQUF3QixxQkFBdUIsV0FDM0JiLFFBQVFDLElBQUksd0JBbUNSWixLQUFBeUIsV0FBYSxTQUFFQyxHQUVuQmYsUUFBUUMsSUFBSSxnQkFFWixJQUFJZSxHQUFpQkMs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QWJuQ3BFLEVBQUFTLFNBQVFBLEdBRmZULFVBQUFBLFlBME1WLElBQUkyRSxJQUVKQyxRQUFPQyxPQUFTLFdBRVovRCxRQUFRQyxJQUFJLGdCQUVaNEQsSUFBTSxHQUFJM0UsU0FBUVMiLCJmaWxlIjoiYWxsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGZtaXhhZ2VudCBvbiAwMS8wMy8yMDE3LlxyXG4gKi9cclxubmFtZXNwYWNlIFRvZG9BcHAge1xyXG5cclxuICAgIGV4cG9ydCBpbnRlcmZhY2UgVG9kb0RhdGEge1xyXG4gICAgICAgIGlkOm51bWJlcjtcclxuICAgICAgICB0b2RvVHh0OnN0cmluZztcclxuICAgIH1cclxuXHJcbiAgICBleHBvcnQgY2xhc3MgVG9kb0l0ZW0ge1xyXG5cclxuICAgICAgICAvLyBET00gRUxFTUVOVFNcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBfdG9kb0RhdGE6VG9kb0RhdGE7XHJcblxyXG4gICAgICAgIGNvbnN0cnVjdG9yICh0b2RvRGF0YTpUb2RvRGF0YSl7XHJcblxyXG4gICAgICAgICAgICAvLyBSZWNvdmVyIGRhdGFcclxuICAgICAgICAgICAgdGhpcy5fdG9kb0RhdGEgPSB0b2RvRGF0YTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGdldEhUTUwoKTpzdHJpbmcge1xyXG5cclxuICAgICAgICAgICAgLy8gQ3JlYXRlIHRlbXBsYXRlIHdpdGggdG9kbyB0ZXh0XHJcbiAgICAgICAgICAgIHZhciBpdGVtSFRNTDpzdHJpbmc7XHJcbiAgICAgICAgICAgIGl0ZW1IVE1MID0gYFxyXG4gICAgICAgICAgICA8bGkgY2xhc3M9XCJsaXN0VU9DLWl0ZW1cIj5cclxuICAgICAgICAgICAgICAgIDxkaXYgaHJlZj1cIiNcIiBjbGFzcz1cImxpc3RVT0MtaXRlbS10b2RvXCI+JHt0aGlzLl90b2RvRGF0YS50b2RvVHh0fTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBkYXRhLWlkPVwiJHt0aGlzLl90b2RvRGF0YS5pZH1cIiAgY2xhc3M9XCJidG4gYnRVT0MgbGlzdFVPQy1pdGVtLXJlbW92ZUJ0IGJ0VU9DLWdyZXlcIj48c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tdHJhc2hcIj48L3NwYW4+IFJlbW92ZTwvYnV0dG9uPlxyXG4gICAgICAgICAgICA8L2xpPlxyXG4gICAgICAgICAgICBgO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1IVE1MO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGZtaXhhZ2VudCBvbiAwMS8wMy8yMDE3LlxyXG4gKi9cclxubmFtZXNwYWNlIFRvZG9BcHAge1xyXG5cclxuICAgIGV4cG9ydCBjbGFzcyBUb2RvTGlzdCB7XHJcblxyXG4gICAgICAgIC8vIFRFTVBMQVRFIHwgRE9NIEVMRU1FTlRTXHJcbiAgICAgICAgc3RhdGljIERPTV9UT0RPTElTVF9DT05UQUlORVI6IHN0cmluZyA9ICcjdG9kby1saXN0LWNvbnRhaW5lcic7XHJcbiAgICAgICAgc3RhdGljIERPTV9UT0RPTElTVDogc3RyaW5nID0gJyN0b2RvLWxpc3QnO1xyXG4gICAgICAgIHN0YXRpYyBET01fTkVXVE9ET19JTlBVVDogc3RyaW5nID0gJyNuZXctdG9kby1pbnB1dCc7XHJcbiAgICAgICAgc3RhdGljIERPTV9TQVZFVE9ET19CVDogc3RyaW5nID0gJyNzYXZlLXRvZG8tYnQnO1xyXG5cclxuICAgICAgICAvLyBTVE9SRSBSRUxBVEVEXHJcbiAgICAgICAgc3RhdGljIERPTV9BTEVSVF9GSVJTVF9USU1FOiBzdHJpbmcgPSAnI2FsZXJ0LWZpcnN0LXRpbWUnO1xyXG4gICAgICAgIHN0YXRpYyBQRVJTSVNURU5UX09CSkVDVF9LRVk6IHN0cmluZyA9ICd0b2RvTGlzdCc7XHJcbiAgICAgICAgc3RhdGljIFBFUlNJU1RFTlRfT0JKRUNUX0RBVEFfUEFUSDogc3RyaW5nID0gJ2RhdGEvZGVmYXVsdGRhdGEuanNvbic7XHJcbiAgICAgICAgc3RhdGljIFBFUlNJU1RFTlRfT0JKRUNUX1RPRE9fSUQ6IHN0cmluZyA9ICdpZCc7XHJcbiAgICAgICAgc3RhdGljIFBFUlNJU1RFTlRfT0JKRUNUX1RPRE9fVFhUOiBzdHJpbmcgPSAndG9kb1R4dCc7XHJcblxyXG4gICAgICAgIC8vIEpRVUVSWSBTRUxFQ1RPUlNcclxuICAgICAgICBwcml2YXRlICR0b2RvTGlzdDogSlF1ZXJ5O1xyXG4gICAgICAgIHByaXZhdGUgJHNhdmVUb2RvQnQ6IEpRdWVyeTtcclxuICAgICAgICBwcml2YXRlICRuZXdUb2RvSW5wdXQ6IEpRdWVyeTtcclxuXHJcbiAgICAgICAgLy8gQVBQIFBSSVZBVEUgVkFSU1xyXG4gICAgICAgIHByaXZhdGUgX3RvZG9MaXN0OiBBcnJheTxUb2RvRGF0YT4gPSBbXTsgICAgLy8gTGlzdCBvZiB0b2Rvc1xyXG4gICAgICAgIHByaXZhdGUgX2lkQ291bnRlcjogbnVtYmVyID0gMDsgICAgICAgICAgICAgLy8gRm9yIHRoZSBuZXh0IHRvZG8gdG8gc2F2ZVxyXG5cclxuICAgICAgICBjb25zdHJ1Y3Rvcigpe1xyXG5cclxuICAgICAgICAgICAgLy8gRE9NIEVMRU1FTlRTXHJcbiAgICAgICAgICAgIHRoaXMuJHRvZG9MaXN0ID0gJChUb2RvTGlzdC5ET01fVE9ET0xJU1QpO1xyXG4gICAgICAgICAgICB0aGlzLiRzYXZlVG9kb0J0ID0gJChUb2RvTGlzdC5ET01fU0FWRVRPRE9fQlQpO1xyXG4gICAgICAgICAgICB0aGlzLiRuZXdUb2RvSW5wdXQgPSAkKFRvZG9MaXN0LkRPTV9ORVdUT0RPX0lOUFVUKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENMSUNLIEVWRU5UU1xyXG4gICAgICAgICAgICB0aGlzLiR0b2RvTGlzdC5vbignY2xpY2snLCAnLmxpc3RVT0MtaXRlbS1yZW1vdmVCdCcsIHRoaXMuZGVsZXRlVG9kbyk7XHJcbiAgICAgICAgICAgIHRoaXMuJHNhdmVUb2RvQnQub24oJ2NsaWNrJywgdGhpcy5zYXZlTmV3VG9kbyk7XHJcbiAgICAgICAgICAgIC8vIERpc2FibGUgZm9ybSBzdWJtaXRcclxuICAgICAgICAgICAgJCgnZm9ybScpLnN1Ym1pdChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gREVGQVVMVFNcclxuICAgICAgICAgICAgdGhpcy5jaGVja1RvZG9MaXN0RGF0YSgpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgcmVuZGVyKCkge1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCIvL1JFTkRFUlwiKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlZmVyZW5jZSB0byB0aGUgRE9NIGVsZW1lbnQgdGhhdCB3aWxsIGNvbnRhaW4gdGhlIHRvZG8gbGlzdFxyXG4gICAgICAgICAgICBsZXQgJHRvZG9MaXN0Q29udGFpbmVyOiBKUXVlcnkgPSAkKFRvZG9MaXN0LkRPTV9UT0RPTElTVF9DT05UQUlORVIpO1xyXG5cclxuICAgICAgICAgICAgLy8gRW1wdHkgb2xkIHRvZG8gbGlzdFxyXG4gICAgICAgICAgICB0aGlzLiR0b2RvTGlzdC5kZXRhY2goKTtcclxuICAgICAgICAgICAgdGhpcy4kdG9kb0xpc3QuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgdG9kbyBsaXN0XHJcbiAgICAgICAgICAgIGZvcihsZXQgaTpudW1iZXI9MDtpPHRoaXMuX3RvZG9MaXN0Lmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW06VG9kb0l0ZW0gPSBuZXcgVG9kb0l0ZW0odGhpcy5fdG9kb0xpc3RbaV0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy4kdG9kb0xpc3QuYXBwZW5kKGl0ZW0uZ2V0SFRNTCgpKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gQWRkIHRvIERPTVxyXG4gICAgICAgICAgICAkdG9kb0xpc3RDb250YWluZXIuYXBwZW5kKCB0aGlzLiR0b2RvTGlzdCApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQWRkIG5ldyB0b2RvXHJcbiAgICAgICAgcHJpdmF0ZSBzYXZlTmV3VG9kbyA9ICggKSA9PiB7XHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIi8vU0FWRSBORVcgVE9ET1wiKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY292ZXIgdG9kbyBkYXRhXHJcbiAgICAgICAgICAgIGxldCB0b2RvVHh0OnN0cmluZyA9IHRoaXMuJG5ld1RvZG9JbnB1dC52YWwoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBsaXN0IGlmIG5ldyB0b2RvIGludHJvZHVjZWRcclxuICAgICAgICAgICAgaWYodG9kb1R4dCE9XCJcIil7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRvZG8gbGlzdFxyXG4gICAgICAgICAgICAgICAgdmFyIG5ld1RvZG86VG9kb0RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRoaXMuX2lkQ291bnRlcixcclxuICAgICAgICAgICAgICAgICAgICB0b2RvVHh0OiB0b2RvVHh0XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRUb2RvKG5ld1RvZG8sIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEVtcHR5IGlucHV0IGZpZWxkXHJcbiAgICAgICAgICAgICAgICB0aGlzLiRuZXdUb2RvSW5wdXQudmFsKFwiXCIpO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNUT1JFIERBVEFcclxuICAgICAgICBwcml2YXRlIGNoZWNrVG9kb0xpc3REYXRhKCkge1xyXG4gICAgICAgICAgICBsZXQgc3RvcmVkRGF0YTogYW55O1xyXG4gICAgICAgICAgICBsZXQgJGFsZXJ0Rmlyc3RUaW1lOiBKUXVlcnk7XHJcblxyXG4gICAgICAgICAgICBzdG9yZWREYXRhID0gc3RvcmUuZ2V0KFRvZG9MaXN0LlBFUlNJU1RFTlRfT0JKRUNUX0tFWSk7XHJcbiAgICAgICAgICAgICRhbGVydEZpcnN0VGltZSA9ICQoVG9kb0xpc3QuRE9NX0FMRVJUX0ZJUlNUX1RJTUUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCBzdG9yZWREYXRhICkge1xyXG4gICAgICAgICAgICAgICAgJGFsZXJ0Rmlyc3RUaW1lLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbkxvYWRUb2Rvc0RhdGFTdWNjZXNzKCBzdG9yZWREYXRhICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIi8vTk8gREFUQVwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9hZEZpcnN0VGltZURhdGEoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHByaXZhdGUgbG9hZEZpcnN0VGltZURhdGEoKSB7XHJcbiAgICAgICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgICAgICB1cmw6IFRvZG9MaXN0LlBFUlNJU1RFTlRfT0JKRUNUX0RBVEFfUEFUSCxcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRoaXMub25Mb2FkVG9kb3NEYXRhU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgIGVycm9yOiB0aGlzLm9uTG9hZFRvZG9zRGF0YUVycm9yXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBvbkxvYWRUb2Rvc0RhdGFTdWNjZXNzID0gKCBkYXRhOmFueSApID0+IHtcclxuICAgICAgICAgICAgbGV0IGk6IG51bWJlcjtcclxuICAgICAgICAgICAgbGV0IG5Ub2RvczogbnVtYmVyO1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudFRvZG9EYXRhOiBUb2RvRGF0YTtcclxuXHJcbiAgICAgICAgICAgIG5Ub2RvcyA9IGRhdGEubGVuZ3RoO1xyXG4gICAgICAgICAgICBmb3IgKGk9MDsgaTxuVG9kb3M7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFRvZG9EYXRhID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkVG9kbyggY3VycmVudFRvZG9EYXRhLCBmYWxzZSApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHByaXZhdGUgb25Mb2FkVG9kb3NEYXRhRXJyb3IgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBsb2FkaW5nIGRhdGEuJyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBzYXZlUGVyc2lzdGVudERhdGEoKSB7XHJcbiAgICAgICAgICAgIGxldCBpOiBudW1iZXI7XHJcbiAgICAgICAgICAgIGxldCBuVG9kb3M6IG51bWJlcjtcclxuICAgICAgICAgICAgbGV0IGN1cnJlbnRUb2RvOiBUb2RvRGF0YTtcclxuICAgICAgICAgICAgbGV0IHNhdmVkVG9kbzogT2JqZWN0O1xyXG4gICAgICAgICAgICBsZXQgdG9kb0xpc3RKU09OOiBPYmplY3RbXTtcclxuXHJcbiAgICAgICAgICAgIHRvZG9MaXN0SlNPTiA9IFtdO1xyXG4gICAgICAgICAgICBuVG9kb3MgPSB0aGlzLl90b2RvTGlzdC5sZW5ndGg7XHJcbiAgICAgICAgICAgIGZvciAoaT0wOyBpPG5Ub2RvczsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50VG9kbyA9IHRoaXMuX3RvZG9MaXN0W2ldO1xyXG5cclxuICAgICAgICAgICAgICAgIHNhdmVkVG9kbyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgc2F2ZWRUb2RvW1RvZG9MaXN0LlBFUlNJU1RFTlRfT0JKRUNUX1RPRE9fSURdID0gY3VycmVudFRvZG8uaWQ7XHJcbiAgICAgICAgICAgICAgICBzYXZlZFRvZG9bVG9kb0xpc3QuUEVSU0lTVEVOVF9PQkpFQ1RfVE9ET19UWFRdID0gY3VycmVudFRvZG8udG9kb1R4dDtcclxuICAgICAgICAgICAgICAgIHRvZG9MaXN0SlNPTi5wdXNoKCBzYXZlZFRvZG8gKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RvcmUuY2xlYXIoKTtcclxuICAgICAgICAgICAgc3RvcmUuc2V0KCBUb2RvTGlzdC5QRVJTSVNURU5UX09CSkVDVF9LRVksIHRvZG9MaXN0SlNPTik7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBhZGRUb2RvICggbmV3VG9kb0RhdGE6VG9kb0RhdGEsIGZvcmNlUmVuZGVyOmJvb2xlYW4gKSB7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl90b2RvTGlzdC5wdXNoKCBuZXdUb2RvRGF0YSApO1xyXG4gICAgICAgICAgICB0aGlzLl9pZENvdW50ZXIrKztcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZVBlcnNpc3RlbnREYXRhKCk7XHJcbiAgICAgICAgICAgIGlmIChmb3JjZVJlbmRlcikgeyB0aGlzLnJlbmRlcigpOyB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBkZWxldGVUb2RvID0gKCBlOkV2ZW50ICkgPT4ge1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCIvL0RFTEVURSBJVEVNXCIpO1xyXG5cclxuICAgICAgICAgICAgbGV0ICR0YXJnZXQ6SlF1ZXJ5ID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJDTElDSzpcIisgcGFyc2VJbnQoICR0YXJnZXQuZGF0YSgnaWQnKSApKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZGVsZXRlVG9kb0J5SWQgKCBwYXJzZUludCggJHRhcmdldC5kYXRhKCdpZCcpICkgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgZGVsZXRlVG9kb0J5SWQgKCBpZDogbnVtYmVyICkge1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUT0RPIERFTEVURURcIik7XHJcblxyXG4gICAgICAgICAgICBsZXQgaTpudW1iZXIgPSAwO1xyXG4gICAgICAgICAgICBsZXQgblRvZG9zOm51bWJlciA9IHRoaXMuX3RvZG9MaXN0Lmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgIGZvcihpPTA7aTxuVG9kb3M7aSsrKXtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuX3RvZG9MaXN0W2ldLmlkID09IGlkICl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdG9kb0xpc3Quc3BsaWNlKGksMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZVBlcnNpc3RlbnREYXRhKCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxufVxyXG5cclxubGV0IGFwcDogVG9kb0FwcC5Ub2RvTGlzdDtcclxuXHJcbndpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XHJcblxyXG4gICAgY29uc29sZS5sb2coXCIvLy8gQVBQIElOSVRcIik7XHJcbiAgICAvLyBUZXN0IHRvZG9JdGVtXHJcbiAgICBhcHAgPSBuZXcgVG9kb0FwcC5Ub2RvTGlzdCgpO1xyXG59O1xyXG4iXX0=
